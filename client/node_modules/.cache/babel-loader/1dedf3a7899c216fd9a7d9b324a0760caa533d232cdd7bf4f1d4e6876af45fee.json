{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faUser,faSearch,faTimes}from\"@fortawesome/free-solid-svg-icons\";import api from\"../config/api\";import moment from\"moment\";import SessionEndedModal from\"../reusables/sessionEndedModal\";import{useNavigate}from\"react-router-dom\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";export default function AdminSubscribersDisplay(){const[allSubscribers,setAllSubscribers]=useState([]);const[displayedSubscribers,setDisplayedSubscribers]=useState([]);const[searchedText,setSearchedText]=useState('');const[isSearchInputActive,setIsSearchInputActive]=useState(false);const[isLoading,setIsLoading]=useState(false);const[showSessionEndedModal,setShowSessionEndedModal]=useState(false);const navigate=useNavigate();useEffect(()=>{setIsLoading(true);api.get('/getSubscribers').then(response=>{console.log(\"fetched subscribers\",response.data.subscribers);setAllSubscribers(response.data.subscribers);setDisplayedSubscribers(response.data.subscribers);setIsLoading(false);}).catch(e=>{setIsLoading(false);console.log(\"Error fetching users: \",e);if(e.response.status===401){navigate('/');setShowSessionEndedModal(true);}});},[]);function handleSearch(e){const text=e.target.value.toLowerCase();setSearchedText(text);const filteredSubscribers=allSubscribers.filter(subscriber=>{const subscriberEmail=subscriber.subscriberEmail.toLowerCase();if(subscriberEmail.includes(text)){return subscriber;}return null;});setDisplayedSubscribers(filteredSubscribers);}return/*#__PURE__*/_jsxs(\"div\",{className:\"container col-lg-7 col-md-9\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"mb-5\",children:[\"Subscribers \",allSubscribers.length!==0&&\"(\".concat(allSubscribers.length,\")\")]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex  mb-4 \",id:\"users-search\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 position-relative d-flex justify-content-between border\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn rounded-0\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSearch})}),/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn position-absolute start-0 top-0 h-100\"// onClick={}\n,style:{zIndex:\"2\",color:\"grey\"},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSearch})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"position-absolute w-100  ps-5 pe-5 start-0 top-0 h-100 border-0\",placeholder:\" Search subscriber email...\",onClick:()=>{setIsSearchInputActive(true);},onChange:handleSearch,value:searchedText,style:{zIndex:\"1\"}}),isSearchInputActive&&/*#__PURE__*/_jsx(\"button\",{className:\"btn position-absolute end-0 top-0 h-100\",onClick:()=>{setIsSearchInputActive(false);setSearchedText('');setDisplayedSubscribers(allSubscribers);},style:{zIndex:\"1\"},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTimes,className:\"ic-grey\"})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-success \",children:/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Loading...\"})})}),/*#__PURE__*/_jsx(\"table\",{className:\"w-100 \",children:displayedSubscribers.map(subscriber=>/*#__PURE__*/_jsx(\"tr\",{className:\"\",children:/*#__PURE__*/_jsxs(\"div\",{className:\" d-flex gap-4 ms-4 me-4 pt-2 align-items-start\",style:{height:\"100px\"},children:[subscriber.subscriberPhoto!==null?/*#__PURE__*/_jsx(\"div\",{style:{width:\"70px\",height:\"70px\"},children:/*#__PURE__*/_jsx(\"img\",{src:subscriber.subscriberPhoto,className:\"rounded-circle w-100 h-100 object-fit-cover\",alt:\"\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"rounded-circle overflow-hidden\",style:{width:\"70px\",height:\"70px\",backgroundColor:\"lightgrey\"},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUser,className:\"ic-white rounded-circle w-100 h-100 pt-2\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[subscriber.userName&&/*#__PURE__*/_jsx(\"span\",{className:\"\",style:{fontWeight:\"500\"},children:subscriber.userName}),/*#__PURE__*/_jsx(\"span\",{className:\"d-block\",style:{fontWeight:\"300\"},children:subscriber.subscriberEmail}),subscriber.userLevel!==1&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{style:{color:\"teal\"},children:\"Subscribed\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"fw-light\",children:[\" \",moment(subscriber.subscriptionDate).fromNow()]})]}),subscriber.userLevel===1&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{style:{color:\"orange\"},children:\"Admin\"})})]})]})}))})]}),/*#__PURE__*/_jsx(SessionEndedModal,{showSessionEndedModal:showSessionEndedModal,setShowSessionEndedModal:setShowSessionEndedModal})]});}","map":{"version":3,"names":["React","useState","useEffect","FontAwesomeIcon","faUser","faSearch","faTimes","api","moment","SessionEndedModal","useNavigate","jsxs","_jsxs","jsx","_jsx","AdminSubscribersDisplay","allSubscribers","setAllSubscribers","displayedSubscribers","setDisplayedSubscribers","searchedText","setSearchedText","isSearchInputActive","setIsSearchInputActive","isLoading","setIsLoading","showSessionEndedModal","setShowSessionEndedModal","navigate","get","then","response","console","log","data","subscribers","catch","e","status","handleSearch","text","target","value","toLowerCase","filteredSubscribers","filter","subscriber","subscriberEmail","includes","className","children","length","concat","id","icon","style","zIndex","color","type","placeholder","onClick","onChange","map","height","subscriberPhoto","width","src","alt","backgroundColor","userName","fontWeight","userLevel","subscriptionDate","fromNow"],"sources":["/home/remoc-revo/Desktop/git_repo/Blog.1/client/src/pages/adminSubscribersDisplay.jsx"],"sourcesContent":["\nimport React,{useState,useEffect} from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faUser,faSearch,faTimes } from \"@fortawesome/free-solid-svg-icons\";\nimport api from \"../config/api\";\nimport moment from \"moment\";\nimport SessionEndedModal from \"../reusables/sessionEndedModal\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function AdminSubscribersDisplay(){\n    const [allSubscribers, setAllSubscribers] = useState([]);\n    const [displayedSubscribers, setDisplayedSubscribers] = useState([])\n    const [searchedText, setSearchedText] = useState('');\n    const [isSearchInputActive, setIsSearchInputActive] = useState(false);\n    const [isLoading, setIsLoading] = useState(false);\n    const [showSessionEndedModal, setShowSessionEndedModal] = useState(false);\n    const navigate = useNavigate();\n\n    useEffect(()=>{\n        setIsLoading(true);\n        api.get('/getSubscribers',)\n            .then((response)=>{\n                console.log(\"fetched subscribers\",response.data.subscribers);\n                setAllSubscribers(response.data.subscribers)\n                setDisplayedSubscribers(response.data.subscribers)\n                setIsLoading(false);\n            })\n            .catch((e)=>{\n                setIsLoading(false);\n                console.log(\"Error fetching users: \",e);\n                if(e.response.status === 401){\n                    navigate('/');\n                    setShowSessionEndedModal(true);\n                }\n            })\n    },[])\n\n\n    function handleSearch(e){\n        const text = e.target.value.toLowerCase();\n        setSearchedText(text);     \n\n        const filteredSubscribers = allSubscribers.filter(\n            subscriber => \n                {\n                    const subscriberEmail = subscriber.subscriberEmail.toLowerCase();\n                    \n                    if(subscriberEmail.includes(text)){            \n                        return subscriber;\n                    }\n\n                    return null;\n                 }\n        )\n\n        setDisplayedSubscribers(filteredSubscribers);\n    }\n\n\n\n    return <div className=\"container col-lg-7 col-md-9\">\n        <h3 className=\"mb-5\">Subscribers {allSubscribers.length !== 0 && `(${allSubscribers.length})`}</h3>\n        <div className=\"d-flex  mb-4 \" id=\"users-search\">\n            <div className=\"col-12 position-relative d-flex justify-content-between border\" >                \n                <button className=\"btn rounded-0\">\n                    <FontAwesomeIcon icon={faSearch}/>\n                </button>                \n                \n                <div className=\"\">\n                    <button className=\"btn position-absolute start-0 top-0 h-100\"\n                        // onClick={}\n                        style={{zIndex:\"2\",color:\"grey\"}}>\n                        <FontAwesomeIcon icon={faSearch}/>\n                    </button>\n                    <input \n                        type=\"text\"\n                        className=\"position-absolute w-100  ps-5 pe-5 start-0 top-0 h-100 border-0\"\n                        placeholder=\" Search subscriber email...\"\n                        onClick={()=>{setIsSearchInputActive(true)}}\n                        onChange={handleSearch}\n                        value={searchedText}\n                        style={{zIndex:\"1\"}}\n                        />\n                    \n                { isSearchInputActive \n                    &&<button className=\"btn position-absolute end-0 top-0 h-100\"\n                        onClick={()=>{\n                            setIsSearchInputActive(false);\n                            setSearchedText('')\n                            setDisplayedSubscribers(allSubscribers);\n                        }}\n                        style={{zIndex:\"1\"}}>\n                        <FontAwesomeIcon icon={faTimes} className=\"ic-grey\"/>\n                    </button>}\n                </div>\n                    \n                \n            </div>\n                \n            </div>\n\n            <div>\n            {\n                isLoading &&\n                <div className=\"d-flex justify-content-center\">\n                    <div className=\"spinner-border text-success \">\n                        <span className=\"sr-only\">Loading...</span>\n                    </div>\n                </div>\n            }\n            <table className=\"w-100 \" >\n                {\n                    displayedSubscribers.map(\n                        subscriber=><tr className=\"\" >\n                            <div className=\" d-flex gap-4 ms-4 me-4 pt-2 align-items-start\" style={{height:\"100px\"}}>\n                            {\n                                    (subscriber.subscriberPhoto !== null)\n                                    ?<div style={{width:\"70px\",height:\"70px\"}}>                                                                                           \n                                        <img src={subscriber.subscriberPhoto}\n                                            className=\"rounded-circle w-100 h-100 object-fit-cover\"\n                                            alt=\"\"\n                                        />\n                                    </div>\n\n                                    :<div className=\"rounded-circle overflow-hidden\" \n                                        style={{width:\"70px\",height:\"70px\", backgroundColor:\"lightgrey\"}}>\n                                        <FontAwesomeIcon icon={faUser} className=\"ic-white rounded-circle w-100 h-100 pt-2\"/>\n                                    </div>\n                                }\n                                <div>\n                                    {   subscriber.userName &&\n                                        <span className=\"\" style={{fontWeight:\"500\"}}>{subscriber.userName}</span>\n                                    }\n\n                                    <span className=\"d-block\" style={{fontWeight:\"300\"}}>{subscriber.subscriberEmail}</span>\n\n                                    {\n                                        subscriber.userLevel !== 1 &&\n                                        (<div className=\"mt-1\">\n                                            <span style={{color:\"teal\"}}>Subscribed</span>\n                                            <span className=\"fw-light\"> {moment(subscriber.subscriptionDate).fromNow()}</span>\n                                        </div>)                                        \n                                    }\n                                    {     subscriber.userLevel === 1 &&\n                                        (<div>\n                                            <span style={{color:\"orange\"}}>Admin</span>\n                                        </div>)\n                                    }\n                                </div>\n                            </div>\n                            \n                                \n                        </tr>\n                    )\n                }\n            </table>\n        </div>\n                <SessionEndedModal showSessionEndedModal={showSessionEndedModal} setShowSessionEndedModal={setShowSessionEndedModal}/>\n\n\n    </div>\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}