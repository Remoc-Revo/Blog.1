{"ast":null,"code":"import{useEffect,useState}from\"react\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faUser,faPenFancy,faBell,faBarsStaggered}from\"@fortawesome/free-solid-svg-icons\";import{useNavigate}from\"react-router-dom\";import api from\"../config/api\";import{decodeString}from\"../reusables/global\";import{formatDateTime}from\"../reusables/global\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AdminNav(_ref){let{toggleSideNav,updateAdminPanelSection}=_ref;const navigate=useNavigate();const[userProfilePhoto,setUserProfilePhoto]=useState(null);const[notifications,setNotifications]=useState([]);const[isFetchingNotifications,setIsFetchingNotifications]=useState(false);const[isDisplayingNotifications,setIsDisplayingNotifications]=useState(false);useEffect(()=>{api.get('/user',{withCredentials:true}).then(response=>{setUserProfilePhoto(response.data.userProfilePhoto);});console.log(\"the user profile photot\",userProfilePhoto);},[userProfilePhoto]);useEffect(()=>{function fetchNotifications(){setIsFetchingNotifications(true);api.get('/getAdminNotifications').then(response=>{setNotifications(response.data.notifications);setIsFetchingNotifications(false);}).catch(err=>{});}fetchNotifications();},[]);function onClickWriteButton(e){e.preventDefault();e.stopPropagation();navigate('/articlePosting/null');}function handleNotificationBtnClick(){setIsDisplayingNotifications(!isDisplayingNotifications);}function handleNotificationClick(notification){console.log(\"notification type: \",notification.notificationType);if(notification.notificationType==='subscription'){updateAdminPanelSection(\"?adminPanel=subscribers\");navigate(\"/?adminPanel=subscribers\");setIsDisplayingNotifications(false);}else if(notification.notificationType==='comment'){const articleId=notification.articleId;const commentId=notification.relatedId;navigate(\"/sngl/\".concat(articleId,\"?scrollTo=comment\").concat(commentId));setIsDisplayingNotifications(false);}}return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-black d-flex justify-content-between m-0  p-1 ps-3 pe-4  top-0 w-100 position-fixed\",style:{height:\"40px\",zIndex:\"1000\"},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn no-focus-outline d-lg-none\",onClick:e=>{e.stopPropagation();toggleSideNav();},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBarsStaggered,className:\"admin-nav-icon\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-end align-items-center gap-2 gap-md-3 \",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn no-focus-outline d-flex align-items-center gap-1\",onClick:onClickWriteButton,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faPenFancy,className:\"admin-nav-icon\"})}),/*#__PURE__*/_jsx(\"div\",{style:{backgroundColor:'lightgrey',width:\"24px\",height:\"24px\"},className:\"d-flex justify-content-center align-items-center rounded-circle overflow-hidden\",onClick:e=>{e.stopPropagation();navigate('/profile');},children:userProfilePhoto!==null?/*#__PURE__*/_jsx(\"img\",{src:userProfilePhoto,alt:\"\",className:\"w-100 h-100 object-fit-cover rounded-circle\",style:{}}):/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUser,className:\"ic-white w-100 h-100 pt-2\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn d-flex\",onMouseOver:()=>setIsDisplayingNotifications(true),onClick:e=>{e.stopPropagation();handleNotificationBtnClick();},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBell,className:\"admin-nav-icon\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-light \".concat(!isDisplayingNotifications?'d-none':'',\" d-flex  flex-column align-items-center  rounded p-3 \"),style:{position:\"absolute\",top:\"55px\",right:\"10px\",zIndex:\"2000\"},onMouseLeave:()=>setIsDisplayingNotifications(false),children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Notifications (\".concat(notifications.length,\")\")}),isFetchingNotifications?/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center justify-content-center\",style:{width:\"300px\",height:\"70vh\"},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-info \",children:/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:\"Loading...\"})})}):/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 \",children:/*#__PURE__*/_jsx(\"div\",{className:\"overflow-scroll no-scrollbar\",style:{width:\"300px\",height:\"70vh\"},children:notifications.map(notification=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 mt-3\",onClick:()=>{handleNotificationClick(notification);},children:[/*#__PURE__*/_jsx(\"p\",{className:\"fw-lighter\",children:decodeString(notification.notificationMessage)}),/*#__PURE__*/_jsxs(\"span\",{style:{fontWeight:\"100\",fontSize:\"13px\",color:\"grey\"},children:[\" \",formatDateTime(notification.createdAt)]}),/*#__PURE__*/_jsx(\"hr\",{})]});})})})]})]});}","map":{"version":3,"names":["useEffect","useState","FontAwesomeIcon","faUser","faPenFancy","faBell","faBarsStaggered","useNavigate","api","decodeString","formatDateTime","jsx","_jsx","jsxs","_jsxs","AdminNav","_ref","toggleSideNav","updateAdminPanelSection","navigate","userProfilePhoto","setUserProfilePhoto","notifications","setNotifications","isFetchingNotifications","setIsFetchingNotifications","isDisplayingNotifications","setIsDisplayingNotifications","get","withCredentials","then","response","data","console","log","fetchNotifications","catch","err","onClickWriteButton","e","preventDefault","stopPropagation","handleNotificationBtnClick","handleNotificationClick","notification","notificationType","articleId","commentId","relatedId","concat","className","style","height","zIndex","children","onClick","icon","backgroundColor","width","src","alt","onMouseOver","position","top","right","onMouseLeave","length","map","notificationMessage","fontWeight","fontSize","color","createdAt"],"sources":["/home/remoc-revo/Desktop/git_repo/Blog.1/client/src/navs/adminNav.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faUser,faPenFancy, faBell,faBarsStaggered } from \"@fortawesome/free-solid-svg-icons\";\nimport { useNavigate } from \"react-router-dom\";\nimport api from \"../config/api\";\nimport { decodeString } from \"../reusables/global\";\nimport { formatDateTime } from \"../reusables/global\";\n\nexport default function AdminNav({toggleSideNav,updateAdminPanelSection}){\n    const navigate = useNavigate();\n    const [userProfilePhoto,setUserProfilePhoto]=useState(null);\n    const [notifications, setNotifications] = useState([]);\n    const [isFetchingNotifications, setIsFetchingNotifications] = useState(false);\n    const [isDisplayingNotifications, setIsDisplayingNotifications] = useState(false);\n\n    useEffect(()=>{\n        api.get('/user',{withCredentials:true})\n        .then((response)=>{\n            setUserProfilePhoto(response.data.userProfilePhoto);\n            \n        })\n        \n          console.log(\"the user profile photot\", userProfilePhoto)\n    \n    },[userProfilePhoto]\n)\n\n    useEffect(()=>{\n        function fetchNotifications(){\n            setIsFetchingNotifications(true);\n            api.get('/getAdminNotifications')\n            .then((response)=>{\n                    setNotifications(response.data.notifications);\n                    setIsFetchingNotifications(false);\n            })\n            .catch((err)=>{\n                \n            })\n        }\n\n        fetchNotifications();\n    },[])\n\n    function onClickWriteButton(e){\n        e.preventDefault();\n        e.stopPropagation();\n        navigate('/articlePosting/null');\n    }\n\n    function handleNotificationBtnClick(){\n        setIsDisplayingNotifications(!isDisplayingNotifications);\n    }\n\n    function handleNotificationClick(notification){\n        console.log(\"notification type: \",notification.notificationType)\n        if(notification.notificationType === 'subscription'){\n            updateAdminPanelSection(\"?adminPanel=subscribers\");\n            navigate(\"/?adminPanel=subscribers\");\n            setIsDisplayingNotifications(false);\n        }\n        else if(notification.notificationType === 'comment'){\n            const articleId = notification.articleId;\n            const commentId = notification.relatedId;\n            navigate(`/sngl/${articleId}?scrollTo=comment${commentId}`);\n            setIsDisplayingNotifications(false);\n        }\n        \n    }\n\n\n    return <div className=\"bg-black d-flex justify-content-between m-0  p-1 ps-3 pe-4  top-0 w-100 position-fixed\" \n        style={{height:\"40px\",zIndex:\"1000\"}}>\n        <div>\n            <button className=\"btn no-focus-outline d-lg-none\" onClick={(e)=>{e.stopPropagation();toggleSideNav()}}>\n                <FontAwesomeIcon icon={faBarsStaggered} className=\"admin-nav-icon\"/>\n            </button>\n        </div>\n        <div className='d-flex justify-content-end align-items-center gap-2 gap-md-3 '>\n            <button className=\"btn no-focus-outline d-flex align-items-center gap-1\" \n                onClick={onClickWriteButton}\n            >\n                <FontAwesomeIcon icon={faPenFancy} className=\"admin-nav-icon\"/>\n            </button>\n\n            <div style={{backgroundColor:'lightgrey', width:\"24px\",height:\"24px\"}}\n                      className=\"d-flex justify-content-center align-items-center rounded-circle overflow-hidden\"\n                      onClick={(e)=>{e.stopPropagation(); navigate('/profile')}}\n                      >\n                      \n                        {\n                        (userProfilePhoto !== null)\n                            ?<img src={userProfilePhoto} alt=\"\" className=\"w-100 h-100 object-fit-cover rounded-circle\" style={{}}/>\n                            :<FontAwesomeIcon icon={faUser} className=\"ic-white w-100 h-100 pt-2\"/>\n\n                        }\n             </div>\n            \n            <button className=\"btn d-flex\"\n                onMouseOver={()=>setIsDisplayingNotifications(true)}\n                onClick={(e)=>{\n                    e.stopPropagation();\n                    handleNotificationBtnClick();\n                }}\n                >\n                <FontAwesomeIcon icon={faBell} className=\"admin-nav-icon\"/>\n            </button>\n        </div>\n\n        <div className={`bg-light ${!isDisplayingNotifications ? 'd-none':''} d-flex  flex-column align-items-center  rounded p-3 `}\n            style={{position:\"absolute\", top:\"55px\", right:\"10px\",zIndex:\"2000\"}}\n            onMouseLeave={()=>setIsDisplayingNotifications(false)}>\n             <h5>{`Notifications (${notifications.length})`}</h5>\n            {\n                isFetchingNotifications\n                ?<div className=\"d-flex align-items-center justify-content-center\" style={{width:\"300px\", height:\"70vh\"}}>\n                    <div className=\"spinner-border text-info \">\n                        <span className=\"sr-only\">Loading...</span>\n                    </div>\n                </div>\n                :<div className=\"mt-2 \" >                   \n                    <div className=\"overflow-scroll no-scrollbar\" style={{width:\"300px\", height:\"70vh\"}}>\n                        {\n                            notifications.map((notification)=>{\n                                return <div className=\"mb-3 mt-3\" onClick={()=>{handleNotificationClick(notification)}}>\n                                            <p className=\"fw-lighter\">{decodeString(notification.notificationMessage)}</p>\n                                            <span style={{fontWeight:\"100\", fontSize:\"13px\", color:\"grey\"}}> {formatDateTime(notification.createdAt)}</span>\n                                            <hr/>\n                                        </div>\n                            })\n                        }\n                    </div>\n                </div>\n            }\n            \n\n        </div>\n        \n    </div>\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}